// --- è¼”åŠ©å‡½æ•¸ï¼šå–å¾—ä¸é‡è¤‡çš„éš¨æ©Ÿæ•¸çµ„ ---
function getRandomNums(count, max, min = 1) {
    let set = new Set();
    while(set.size < count) set.add(Math.floor(Math.random() * (max - min + 1)) + min);
    return Array.from(set);
}

// 1. Aå€ï¼šè³“æœé€£ç·š (å¾¹åº•éš¨æ©ŸåŒ–)
function createBingoZone(winAmt) {
    const isWin = winAmt > 0;
    let nums = getRandomNums(9, 30); // éš¨æ©ŸæŠ½9å€‹è™Ÿç¢¼
    if (isWin) {
        // å¼·åˆ¶è®“ç¬¬ä¸€æ©«åˆ—é€£ç·š (çœŸå¯¦æƒ…æ³æœƒéš¨æ©Ÿé€£ç·šï¼Œé€™è£¡å…ˆä¿è­‰è¦–è¦ºä¸­ç)
        const winLine = getRandomNums(3, 30);
        nums[0] = winLine[0]; nums[1] = winLine[1]; nums[2] = winLine[2];
    }
    return `<div class="game-zone">
        <div class="zone-title">Aå€ï¼šè³“æœé€£ç·š</div>
        <div class="bingo-grid">${nums.map((n,i)=>`<div class="num-box ${isWin && i<3?'match':''}">${n}</div>`).join('')}</div>
        <div style="font-size:12px; margin-top:5px;">çé‡‘: $${winAmt.toLocaleString()}</div>
    </div>`;
}

// 2. Bå€ï¼šå¹¸é‹ç¬¦è™Ÿ (æ“´å……åœ–æ¡ˆæ± )
function createSymbolZone(winAmt) {
    const pool = ['ğŸ’','ğŸ€','ğŸ','ğŸ’','ğŸ””','ğŸ‹','ğŸ’°','â­','ğŸ§§'];
    let syms = [];
    if (winAmt > 0) {
        const winSym = pool[Math.floor(Math.random()*pool.length)];
        syms = [winSym, winSym, winSym];
        while(syms.length < 5) syms.push(pool[Math.floor(Math.random()*pool.length)]);
    } else {
        syms = getRandomNums(5, pool.length-1, 0).map(idx => pool[idx]);
    }
    syms.sort(() => Math.random() - 0.5);
    return `<div class="game-zone">
        <div class="zone-title">Bå€ï¼šå¹¸é‹ç¬¦è™Ÿ (3å€‹ç›¸åŒå³ä¸­)</div>
        <div style="font-size:24px; letter-spacing:10px;">${syms.join('')}</div>
        <div style="font-size:12px; margin-top:5px;">çé‡‘: $${winAmt.toLocaleString()}</div>
    </div>`;
}

// 3. ABå€ï¼š300å…ƒå°ˆç”¨ (å¤§æ± å­æŠ½è™Ÿç¢¼)
function createNumberZone(winAmt) {
    const luckyPool = getRandomNums(15, 99);
    let myPool = getRandomNums(20, 99);
    
    if (winAmt > 0) {
        const matchCount = winAmt >= 1000 ? 6 : 4;
        for(let i=0; i<matchCount; i++) myPool[i] = luckyPool[i];
    } else {
        // ç¢ºä¿ä¸ä¸­ç (éæ¿¾æ‰å¹¸é‹è™Ÿç¢¼)
        myPool = myPool.filter(n => !luckyPool.includes(n));
        while(myPool.length < 20) {
            let n = Math.floor(Math.random()*99)+1;
            if(!luckyPool.includes(n)) myPool.push(n);
        }
    }
    myPool.sort(() => Math.random() - 0.5);
    
    return `<div class="game-zone">
        <div class="zone-title">ABå€ï¼šå¹¸é‹å°ç</div>
        <div style="font-size:10px; color:#666;">å¹¸é‹è™Ÿç¢¼ï¼š${luckyPool.join(', ')}</div>
        <div class="number-pool" style="margin-top:8px;">
            ${myPool.map(n => `<span class="${luckyPool.includes(n)?'match':''}">${n}</span>`).join(' ')}
        </div>
        <div style="font-size:12px; margin-top:5px;">çé‡‘: $${winAmt.toLocaleString()}</div>
    </div>`;
}

// 4. Då€ï¼š2000å…ƒå°ˆç”¨ (è™Ÿç¢¼+é‡‘é¡éš¨æ©ŸåŒ–)
function createDZone(winAmt) {
    const lucky = getRandomNums(2, 99);
    const myNums = getRandomNums(9, 99);
    const amounts = [100, 200, 500, 1000, 2000, 5000, 10000];
    
    if (winAmt > 0) {
        myNums[0] = lucky[0]; // ä¿è­‰ç¬¬ä¸€å€‹è™Ÿç¢¼ä¸­ç
    } else {
        // ç¢ºä¿ä¸ä¸­ç
        for(let i=0; i<myNums.length; i++) {
            if(lucky.includes(myNums[i])) myNums[i] = (myNums[i]+1)%100;
        }
    }

    let html = `<div class="game-zone"><div class="zone-title">Då€ï¼šå¹¸é‹è™Ÿç¢¼</div>`;
    html += `<div style="font-size:14px; margin-bottom:5px;">å¹¸é‹ï¼š<b style="color:red">${lucky.join(' ')}</b></div>`;
    html += `<div class="number-pool" style="display:grid; grid-template-columns:repeat(3,1fr); gap:8px;">`;
    
    myNums.forEach((n, i) => {
        const isMatch = lucky.includes(n);
        const displayAmt = isMatch ? winAmt : amounts[Math.floor(Math.random()*amounts.length)];
        html += `<div style="border:1px solid #ddd; padding:4px; ${isMatch?'background:#fff9c4':''}">
                    <b style="${isMatch?'color:red':''}">${n}</b><br>
                    <small style="color:#777">$${displayAmt.toLocaleString()}</small>
                 </div>`;
    });
    html += `</div></div>`;
    return html;
}
